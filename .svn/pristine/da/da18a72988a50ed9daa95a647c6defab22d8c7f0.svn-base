<template>
  <div class="ccbCustomerDetail">
    <div class="top">
      <p @click="leftBack">
        <img src="../../images/goback.png" alt />
        <span>{{ stationDetail.serverName }}</span>
      </p>
      <div>
        <p>
          <img src="../../images/name.png" alt />
          <span>{{ stationDetail.customerName }}</span>
        </p>
        <p>
          <img src="../../images/secondBank-b.png" alt />
          <span>{{ stationDetail.secondBank }}</span>
        </p>
      </div>
    </div>
    <!-- top -->
    <van-tabs
      @click="onClick"
      title-active-color="#1c92ff"
      line-width="0"
      line-height="0"
      v-model="stationActive"
    >
      <van-tab title="站点基本情况" name="站点基本情况">
        <div class="base-box">
          <template v-if="isErr">
            <div class="err-con">
              <span class="err-text">接口请求失败,请稍后重试</span>
              <van-button plain  round  type="info" size="small" @click="detail()">点击重试</van-button>
            </div>
          </template>
          <template v-else>
            <div class="base-left-con">
              <div class="base-left-item" :class="{'opacity': curScrollTop >= 0 && curScrollTop < scrollTop2 - 50}" @click="changeScroll(1)">站长信息</div>
              <div class="base-left-item"  :class="{'opacity': curScrollTop >= scrollTop2-50 && curScrollTop < scrollTop3 - 200}" @click="changeScroll(2)">站点信息</div>
              <div class="base-left-item" :class="{'opacity': curScrollTop >= scrollTop3 - 200 && curScrollTop < scrollTop4 - 8}" @click="changeScroll(3)">客户信息</div>
              <div class="base-left-item" :class="{'opacity': curScrollTop >= scrollTop4 - 8}" @click="changeScroll(4)">交易数据</div>
            </div>
            <div class="base-right-con" ref="baseRightCon">
              <p class="dataTitle" id="zhanzhang">站长信息</p>
              <div class="marBottom">
              <!-- 姓名可编辑 -->
              <van-field
                placeholder="请输入站长姓名"
                label="站长姓名"
                left-icon="http://sc.xfd365.com/crmImages/name.png"
                input-align="right"
                v-model="tab1Name"
                @input="changeInput"
              />
              <!-- 性别可编辑 -->
              <van-field
                placeholder="请选择性别"
                label="性别"
                is-link
                readonly
                left-icon="http://sc.xfd365.com/crmImages/sex.png"
                input-align="right"
                v-model="tab1Sex"
                @click="isSex=true"
              />
            <!-- 手机号可编辑 -->
            <van-field
              placeholder="请输入签约手机号"
              type="tel"
              label="签约手机号"
              left-icon="http://sc.xfd365.com/crmImages/phone.png"
              input-align="right"
              v-model="tab1Mobile"
              maxlength="11"
              @blur="blurInput"
            />
            <!-- 年龄 -->
              <van-field
                placeholder="请选择站长出生年月"
                label="出生年月"
                left-icon="http://sc.xfd365.com/crmImages/birthday.png"
                input-align="right"
                v-model="dateBirth"
                readonly
                @click="isBirth=true"
              />
            <van-field
              placeholder="请选择教育水平"
              label="教育水平"
              is-link
              readonly
              left-icon="http://sc.xfd365.com/crmImages/education.png"
              input-align="right"
              v-model="tab1Educatione"
              @click="isEducate=true"
            />
            <!-- <div class="listLi">
              <span class="iconImg"
                ><img src="http://sc.xfd365.com/crmImages/card.png" alt
              /></span>
              <span class="title">身份证号</span>
              <span class="desc">{{siteDetail.idcard}}</span>
            </div> -->
          </div>
          <p class="dataTitle" id="zhandian">站点信息</p>
          <div class="marBottom">
            <div class="listLi">
              <span class="iconImg"
                ><img src="http://sc.xfd365.com/crmImages/dingwei.png" alt
              /></span>
              <span class="title">经营地址</span>
              <span class="desc">{{ tab3BusRegion ? tab3BusRegion : (stationDetail && stationDetail.station_address ? stationDetail.station_address : '') }}</span>
            </div>
            <van-field
              placeholder="请输入经营类型"
              label="经营类型"
              left-icon="http://sc.xfd365.com/crmImages/type.png"
              input-align="right"
              v-model="tab3BusType"
              @input="changeInput"
            />
            <van-field
              placeholder="请选择经营规模"
              label="经营规模"
              is-link
              readonly
              left-icon="http://sc.xfd365.com/crmImages/busnumber.png"
              input-align="right"
              v-model="tab3BusNumber"
              @click="isBusNumber=true"
            />
            <van-field
              placeholder="请选择银行业务熟悉情况"
              label="银行业务熟悉情况"
              is-link
              readonly
              left-icon="http://sc.xfd365.com/crmImages/education.png"
              input-align="right"
              v-model="bankWork"
              @click="isBankType=true"
            />
            <van-field
              placeholder="请选择裕农通设备"
              label="裕农通设备"
              is-link
              readonly
              left-icon="http://sc.xfd365.com/crmImages/shebei.png"
              input-align="right"
              v-model="tab3BusEquipment"
              @click="isBusEquipment=true"
            />
            <van-field
              placeholder="请输入办卡数量"
              label="办卡数量"
              left-icon="http://sc.xfd365.com/crmImages/carnum.png"
              input-align="right"
              :maxlength="5"
              v-model="tab3BusCardNum"
              @blur="blurInput"
            />
            <van-cell title="门头" icon="http://sc.xfd365.com/crmImages/door.png" is-link></van-cell>
            <van-uploader v-model="tab2BusDoorPicList" :after-read="afterRead2" :before-delete="beforeDelete2" />

            <van-cell title="店内环境" icon="http://sc.xfd365.com/crmImages/shopin.png" is-link></van-cell>
            <van-uploader v-model="tab2BusInPicList" :after-read="afterRead3" :before-delete="beforeDelete3" />

            <van-cell title="营业执照" icon="http://sc.xfd365.com/crmImages/pic.png" is-link></van-cell>
            <van-uploader v-model="tab2BusPicList" :after-read="afterRead1" :before-delete="beforeDelete1" />

            <van-field name="radio" label="建行信用卡" class="ifCcb" left-icon="http://sc.xfd365.com/crmImages/ccb.png">
              <template #input>
                <van-radio-group v-model="tab3BusCcbRadio" direction="horizontal" @change="tab3BusCcbRadioChange">
                  <van-radio name="1">有</van-radio>
                  <van-radio name="0">无</van-radio>
                </van-radio-group>
              </template>
            </van-field>

            <van-cell title="上传建行收款码" icon="http://sc.xfd365.com/crmImages/moneycode.png" is-link></van-cell>
            <van-uploader v-model="tab3BusCcbPicList" :after-read="afterRead4" :before-delete="beforeDelete4" />
          </div>
          <p class="dataTitle" id="kehu">客户信息</p>
              <div class="marBottom" id="kehuCon">
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/name.png" alt
                  /></span>
                  <span class="title">客户姓名</span>
                  <span class="desc">{{ stationDetail.customerName }}</span>
                </div>
                <template v-if="stationDetail.phones">
                  <a :href="'tel:' + stationDetail.phones" class="listLi">
                    <span class="iconImg"
                      ><img src="http://sc.xfd365.com/crmImages/phone.png" alt
                    /></span>
                    <span class="title">联系方式</span>
                    <span class="desc">{{ stationDetail.phones }}</span>
                  </a>
                </template>
                <template v-else>
                  <van-field
                    placeholder="请输入手机号码"
                    type="tel"
                    label="联系电话"
                    left-icon="http://sc.xfd365.com/crmImages/phone.png"
                    input-align="right"
                    v-model="phones"
                    @blur="editPhones"
                    maxlength="11"
                  />
                </template>
                <div class="listLi tagLi" @click="tagList">
                  <!-- <div class="listLi tagLi" @click="isType=true"> -->
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/tag.png" alt
                  /></span>
                  <span class="title">客户标签</span>
                  <span class="desc">
                    <span
                      v-for="(item, index) in labelArray"
                      :key="index"
                      class="tips"
                      >{{ item }}</span
                    >
                  </span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/noServer.png" alt
                  /></span>
                  <span class="title">服务点编号</span>
                  <span class="desc">{{ stationDetail.serverNo }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/customerName.png" alt
                  /></span>
                  <span class="title">服务点名称</span>
                  <span class="desc">{{ stationDetail.serverName }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/noIntnet.png" alt
                  /></span>
                  <span class="title">所属网点编号</span>
                  <span class="desc">{{ stationDetail.netNo }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/InternetName.png" alt
                  /></span>
                  <span class="title">所属网点名称</span>
                  <span class="desc">{{ stationDetail.netName }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/firstBank.png" alt
                  /></span>
                  <span class="title">所属一级行</span>
                  <span class="desc">{{ stationDetail.firstBank }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/secondBank.png" alt
                  /></span>
                  <span class="title">所属二级行</span>
                  <span class="desc">{{ stationDetail.secondBank }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/date.png" alt
                  /></span>
                  <span class="title title7">服务点激活日期</span>
                  <span class="desc">{{ activeDate }}</span>
                </div>
              </div>
              <!-- <div class="marBottom">
                <van-field
                  placeholder="业主姓名"
                  label="业主姓名"
                  readonly
                  left-icon="http://sc.xfd365.com/crmImages/name.png"
                  input-align="right"
                  v-model="stationDetail.customerName"
                />
              </div> -->
              <p class="dataTitle" id="jiaoyi">交易数据统计</p>
              <div class="numDetail" style="margin-bottom: 0" id="jiaoyiCon">
                <div class="ulDiv">
                  <div>
                    <span>{{ stationDetail.server_year_deal_num }}</span>
                    <span>本年交易笔数</span>
                  </div>
                  <div>
                    <span>{{ stationDetail.server_year_deal_money }}</span>
                    <span>本年交易金额</span>
                  </div>
                  <div>
                    <span>{{ stationDetail.server_deal_num }}</span>
                    <span>累计交易笔数</span>
                  </div>
                  <div>
                    <span>{{ stationDetail.server_deal_money }}</span>
                    <span>累计交易金额</span>
                  </div>
                  <div>
                    <span>{{ stationDetail.server_sign_num }}</span>
                    <span>服务点签约卡量</span>
                  </div>
                  <div>
                    <span>{{ stationDetail.server_signyi_num }}</span>
                    <span>签约益农卡量</span>
                  </div>
                </div>
              </div>
            </div>
          </template>
        </div>
      </van-tab>
      <van-tab title="业绩及跟进" name="业绩及跟进">
        <div class="base-other-box">
          <ul class="tipList" v-if="tipList.length > 0">
            <li class="keyword" :class="selectId == '' || selectId == undefined ? 'active' : ''" @click="selTip()">全部</li>
            <li
              class="keyword"
              :class="selectId == item1.user_id ? 'active' : ''"
              v-for="(item1, index1) in tipList"
              :key="index1"
              @click="selTip(item1.user_id)"
            >
              {{ item1.user_name }}
            </li>
          </ul>
          <div v-for="(item, index) in genjin" :key="index" class="genjinlCont">
            <p class="fllow-title">{{ item.follow_time }}</p>
            <ul @click="genjinDetail(item.follow_id)">
              <li>
                <img src="../../images/avatar1.png" alt />
                <span>{{item.user_name}}</span>
                <!-- <span>市场专员</span> -->
                <span class="tip" v-if="item.role==2">超级管理员</span>
                <span class="tip" v-else-if="item.role==3">区域管理员</span>
                <span class="tip" v-else>市场专员</span>
                <span class="num">第{{item.num}}次</span>
              </li>
              <li>
                <img src="../../images/info.png" alt />
                <span>{{ item.content }}</span>
              </li>
              <li>
                <img src="../../images/time.png" alt />
                <span>{{ item.follow_time }}</span>
              </li>
              <li v-if="item.address">
                <img src="../../images/time.png" alt />
                <span>{{ item.address }}</span>
              </li>
              <li>
                <img src="../../images/customerStatus.png" alt />
                <span v-if="item.type == 1">到访</span>
                <span v-else-if="item.type == 2">电话</span>
                <span v-else-if="item.type == 3">微信</span>
                <span v-else-if="item.type == 4">短信</span>
                <span v-else-if="item.type == 5">其他</span>
              </li>
            </ul>
            <p class="detailBtn" @click="genjinDetail(item.follow_id)">
              查看详情
            </p>
          </div>
          <van-loading v-if="loading" size="24px">加载中...</van-loading>
        </div>
      </van-tab>
      <van-tab title="站点风险情况">
        <div class="base-other-box">
          <template v-if="isErr">
            <div class="err-con">
              <span class="err-text">接口请求失败,请稍后重试</span>
              <van-button plain  round  type="info" size="small" @click="detail()">点击重试</van-button>
            </div>
          </template>
          <template v-else>
              <div class="marBottom">
                <van-field name="radio" label="站点VI标识" class="ifCcb" left-icon="http://sc.xfd365.com/crmImages/vi.png">
                  <template #input>
                    <van-radio-group v-model="tab3BusVIRadio" direction="horizontal" @change="tab3BusVIRadioChage">
                      <van-radio name="有">有</van-radio>
                      <van-radio name="无">无</van-radio>
                      <van-radio name="缺失">缺失</van-radio>
                    </van-radio-group>
                  </template>
                </van-field>
                <van-field
                  placeholder="请选择风险情况"
                  label="风险情况"
                  is-link
                  readonly
                  left-icon="http://sc.xfd365.com/crmImages/fengxian.png"
                  input-align="right"
                  v-model="tab3BusRisk"
                  @click="isBusRisk=true"
                />
                </div>
                <!-- <div class="marBottom">
                <van-field
                  placeholder="请输入站长姓名"
                  label="站长姓名"
                  left-icon="http://sc.xfd365.com/crmImages/name.png"
                  input-align="right"
                  v-model="tab1Name"
                  @input="changeInput"
                />
                <van-field
                  placeholder="请输入签约手机号"
                  type="tel"
                  label="签约手机号"
                  left-icon="http://sc.xfd365.com/crmImages/phone.png"
                  input-align="right"
                  v-model="tab1Mobile"
                  maxlength="11"
                  @blur="blurInput"
                />
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/card.png" alt
                  /></span>
                  <span class="title">身份证号</span>
                  <span class="desc">{{siteDetail.idcard}}</span>
                </div>
              </div>
              <div class="marBottom">
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/nation.png" alt
                  /></span>
                  <span class="title">民族</span>
                  <span class="desc">{{siteDetail.nation}}</span>
                </div>
                <van-field
                  placeholder="请选择性别"
                  label="性别"
                  is-link
                  readonly
                  left-icon="http://sc.xfd365.com/crmImages/sex.png"
                  input-align="right"
                  v-model="tab1Sex"
                  @click="isSex=true"
                />
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/birthday.png" alt
                  /></span>
                  <span class="title">出生年月</span>
                  <span class="desc">{{siteDetail.date_of_birth}}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/education.png" alt
                  /></span>
                  <span class="title">教育程度</span>
                  <span class="desc">{{siteDetail.edu}}</span>
                </div>
              </div>
              <div class="marBottom">
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/wechat.png" alt
                  /></span>
                  <span class="title">微信号</span>
                  <span class="desc">{{siteDetail.wx_mobile}}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/zuoji.png" alt
                  /></span>
                  <span class="title">住宅电话</span>
                  <span class="desc">{{ siteDetail.address_phone }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/youbian.png" alt
                  /></span>
                  <span class="title">邮政编码</span>
                  <span class="desc">{{ siteDetail.postal_code }}</span>
                </div>
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/dingwei.png" alt
                  /></span>
                  <span class="title">邮寄地址</span>
                  <span class="desc">{{ tab1Region }}</span>
                </div>
              </div>
              <div class="marBottom">
                <div class="listLi">
                  <span class="iconImg"
                    ><img src="http://sc.xfd365.com/crmImages/marriage.png" alt
                  /></span>
                  <span class="title">婚姻状况</span>
                  <span class="desc">{{ siteDetail.marital }}</span>
                </div>
                <template v-if="siteDetail.marital == '已婚'">
                  <div class="listLi">
                    <span class="iconImg"
                      ><img src="http://sc.xfd365.com/crmImages/name.png" alt
                    /></span>
                    <span class="title">配偶姓名</span>
                    <span class="desc">{{ siteDetail.spouse_name }}</span>
                  </div>
                  <div class="listLi">
                    <span class="iconImg"
                      ><img src="http://sc.xfd365.com/crmImages/phone.png" alt
                    /></span>
                    <span class="title">配偶联系方式</span>
                    <span class="desc">{{ siteDetail.spouse_phone }}</span>
                  </div>
                  <div class="listLi">
                    <span class="iconImg"
                      ><img src="http://sc.xfd365.com/crmImages/card.png" alt
                    /></span>
                    <span class="title">配偶身份证号</span>
                    <span class="desc">{{ siteDetail.spouse_idcard }}</span>
                  </div>
                </template>

              </div>
              <div class="bottomTip">
                <p v-if="currentDateNow != '暂未填写'">填写人:{{ userName }}</p>
                <p>填写日期:{{ currentDateNow }}</p>
              </div> -->
          </template>
        </div>
      </van-tab>
      <!-- <van-tab title="站点资料">
        <div class="marBottom">
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/business.png" alt
            /></span>
            <span class="title">营业执照名称</span>
            <span class="desc">{{ siteDetail.business_name }}</span>
          </div>
        </div>

        <div class="marBottom">
          <van-cell title="营业执照" icon="http://sc.xfd365.com/crmImages/pic.png" is-link></van-cell>
          <van-uploader v-model="tab2BusPicList" :after-read="afterRead1" :before-delete="beforeDelete1" />
        </div>

        <div class="marBottom">
          <van-cell title="门头" icon="http://sc.xfd365.com/crmImages/door.png" is-link></van-cell>
          <van-uploader v-model="tab2BusDoorPicList" :after-read="afterRead2" :before-delete="beforeDelete2" />
        </div>

        <div class="marBottom">
          <van-cell title="店内环境" icon="http://sc.xfd365.com/crmImages/shopin.png" is-link></van-cell>
          <van-uploader v-model="tab2BusInPicList" :after-read="afterRead3" :before-delete="beforeDelete3" />
        </div>

        <div class="bottomTip">
          <p v-if="currentDateNow != '暂未填写'">填写人:{{ userName }}</p>
          <p>填写日期:{{ currentDateNow }}</p>
        </div>
      </van-tab> -->
      <!-- <van-tab title="站点详情">
        <div class="marBottom">
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/busentity.png" alt
            /></span>
            <span class="title">经营主体</span>
            <span class="desc">{{ siteDetail.business }}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/busname.png" alt
            /></span>
            <span class="title">经营场所名称</span>
            <span class="desc">{{ siteDetail.business_site_name }}</span>
          </div>
          <van-field
            placeholder="请输入经营类型"
            label="经营类型"
            left-icon="http://sc.xfd365.com/crmImages/type.png"
            input-align="right"
            v-model="tab3BusType"
            @input="changeInput"
          />
          
        </div>
       
        <div class="marBottom">
          <van-field name="radio" label="站点VI标识" class="ifCcb" left-icon="http://sc.xfd365.com/crmImages/vi.png">
            <template #input>
              <van-radio-group v-model="tab3BusVIRadio" direction="horizontal" @change="tab3BusVIRadioChage">
                <van-radio name="有">有</van-radio>
                <van-radio name="无">无</van-radio>
                <van-radio name="缺失">缺失</van-radio>
              </van-radio-group>
            </template>
          </van-field>
          <van-field
            placeholder="请选择风险情况"
            label="风险情况"
            is-link
            readonly
            left-icon="http://sc.xfd365.com/crmImages/fengxian.png"
            input-align="right"
            v-model="tab3BusRisk"
            @click="isBusRisk=true"
          />
        </div>
        <div class="marBottom">
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/busarea.png" alt
            /></span>
            <span class="title">经营面积</span>
            <span class="desc">{{ siteDetail.business_size }}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/busmoney.png" alt
            /></span>
            <span class="title">年交易额</span>
            <span class="desc">{{ siteDetail.year_amount }}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/busnumber.png" alt
            /></span>
            <span class="title">从业人数</span>
            <span class="desc">{{ siteDetail.the_num }}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/dingwei.png" alt
            /></span>
            <span class="title">经营地址</span>
            <span class="desc">{{ tab3BusRegion }}</span>
          </div>
        </div>
        <div class="bottomTip">
          <p v-if="currentDateNow != '暂未填写'">填写人:{{ userName }}</p>
          <p>填写日期:{{ currentDateNow }}</p>
        </div>
      </van-tab> -->
      <!-- <van-tab title="站点使用情况">
        <div class="marBottom">
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/cardnumber.png" alt
            /></span>
            <span class="title title10">持有信用卡数量</span>
            <span class="desc">{{ siteDetail.hold_card }}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/loan.png" alt
            /></span>
            <span class="title">贷款情况</span>
            <span class="desc">{{siteDetail.loans}}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/payment.png" alt
            /></span>
            <span class="title">常用收款方式</span>
            <span class="desc">{{siteDetail.payment_term}}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/hebanknum.png" alt
            /></span>
            <span class="title title10">站点合作银行数量</span>
            <span class="desc">{{siteDetail.site_he_bank}}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/firstBank.png" alt
            /></span>
            <span class="title">合作银行名称</span>
            <span class="desc">{{siteDetail.site_he_bankname}}</span>
          </div>
          <div class="listLi">
            <span class="iconImg"
              ><img src="http://sc.xfd365.com/crmImages/nearybank.png" alt
            /></span>
            <span class="title title10">1公里内银行网点数量</span>
            <span class="desc">{{siteDetail.one_bane}}</span>
          </div>
        </div>
        <div class="bottomTip">
          <p v-if="currentDateNow != '暂未填写'">填写人:{{ userName }}</p>
          <p>填写日期:{{ currentDateNow }}</p>
        </div>
      </van-tab> -->
    </van-tabs>

    <ul class="bottom">
      <li @click="toGenjin(customer_id, stationDetail.customerName, site_id)">
        <img src="../../images/genjin.png" alt />
        <span>写新跟进</span>
      </li>
      <li @click="isPhone = true">
        <img src="../../images/telephone.png" alt />
        <span>拨打电话</span>
      </li>
      <li @click="siteStatiseAdd(customer_id, site_id)">
        <img src="../../images/inzhandian.png" alt />
        <span>站点信息修改</span>
      </li>
    </ul>
    <van-action-sheet
      class="vanSheet"
      v-model="isPhone"
      title="拨打电话"
      :round="isRound"
    >
      <a
        :href="'tel:' + stationDetail.phones"
        style="color: #000; padding: 20px; display: block"
        @click="dialNum"
        >{{ stationDetail.phones }}</a
      >
    </van-action-sheet>

    <!-- 选择性别 -->
    <van-action-sheet class="sexSheet" v-model="isSex" title="请选择性别" :round="isRound">
      <ul>
        <li v-for="(item,index) in sexs" :key="index" @click="selectSex(index)">
          <img :src="item" alt />
        </li>
      </ul>
    </van-action-sheet>
        <!-- 裕农通设备 -->
    <van-action-sheet
      class="listSheet"
      v-model="isBusEquipment"
      title="经营主体"
      :actions="busEquipmentType"
      @select="onSelectBusEquipment"
      :round="isRound"
    ></van-action-sheet>

    <!-- 风险情况 -->
    <van-action-sheet
      class="listSheet"
      v-model="isBusRisk"
      title="经营主体"
      :actions="busRiskType"
      @select="onSelectBusRisk"
      :round="isRound"
    ></van-action-sheet>

    <van-popup class="tagPopup"  v-model="isType" @click-overlay="closePopup">
      <div class="content">
        <div class="imgDiv">
          <img src="http://sc.xfd365.com/crmImages/tags.png" alt />
        </div>
        <p>*可以选择多种标签</p>
        <ul>
          <li
            v-for="(item, index) in type"
            :key="index"
            :class="item.ischecked ? 'active' : ''"
            @click="item.ischecked = !item.ischecked"
          >
            {{ item.tag_name }}
          </li>
        </ul>
        <button @click="closeType">确定</button>
      </div>
    </van-popup>

    <!-- 选择出生日期 -->
    <van-popup v-model="isBirth" position="bottom" style="height: 264px">
      <van-datetime-picker
        v-model="currentDate"
        type="date"
        :min-date="minDate"
        v-show="isBirth"
        @confirm="handleTime"
        @cancel="isBirth=false"
      />
    </van-popup>
    <!-- 教育水平 -->
    <van-action-sheet
      class="listSheet"
      v-model="isEducate"
      title="教育程度"
      :actions="educateType"
      @select="onSelectEducate"
      :round="false"
    ></van-action-sheet>

    <!-- 经营规模 -->
    <van-action-sheet
      class="listSheet"
      v-model="isBusNumber"
      title="经营规模"
      :actions="busNumberType"
      @select="onSelectBusNumber"
      :round="false"
    ></van-action-sheet>

    <!-- 银行业务熟悉情况 -->
    <van-action-sheet
      class="listSheet"
      v-model="isBankType"
      title="经营规模"
      :actions="bankType"
      @select="onSelectBankType"
      :round="false"
    ></van-action-sheet>

  </div>
</template>
<script>
import Exif from "exif-js";
export default {
  name: "ccbCustomerDetail",
  data() {
    return {
      stationActive: "站点基本情况",
      stationDetail: {},
      selectId: '',
      tipList: [],

      loading: 1,
      page: 1,
      pageSize: 3,
      totalPage: 1,
      genjin: [],

      userName: "",
      activeDate: "",
      customer_id: "",
      labelArray: [],
      isType: false,
      type: [],
      // deletable: false, // 是否展示删除按钮
      // showUpload: false, // 是否展示上传区域

      siteDetail: '',
      site_id: "",
      tab1Name: "",
      tab1Mobile: "",

      dateBirth: "",
      currentDate: new Date(),
      minDate: new Date(1900, 1, 1),
      isBirth: false,

      tab1Educatione: "",
      isEducate: false,
      educateType: [
        { name: "本科及以上" },
        { name: "大专" },
        { name: "中专或高中" },
        { name: "初中及以下" }
      ],

      isBankType: false,
      bankType: [
        { name: "良好" },
        { name: "一般" },
        { name: "较差" }
      ],
      bankWork: "",

      isSex: false,
      sexs: [require("../../images/male.png"), require("../../images/female.png")],
      tab1Sex: "",
      tab1Region: "",

      tab2BusPicList: [],
      tab2BusPics: "",
      tab2BusPicsArray: [],

      tab2BusDoorPicList: [],
      tab2BusDoorPics: "",
      tab2BusDoorPicsArray: [],

      tab2BusInPicList: [],
      tab2BusInPics: "",
      tab2BusInPicsArray: [],

      tab3BusType: '',
      isBusEquipment: false,
      busEquipmentType: [
        { name: "APP" },
        { name: "POS" },
        { name: "互动触摸屏" }
      ],
      tab3BusEquipment: "",
      tab3BusCardNum: '',
      tab3BusCcbRadio: '',
      tab3BusVIRadio: '',
      tab3BusCcbPicList: [],
      tab3BusCcbPics: "",
      tab3BusCcbPicsArray: [],
      tab3BusVIRadio: '',
      isBusRisk: false,
      busRiskType: [
        { name: "低风险" },
        { name: "中风险" },
        { name: "高风险" }
      ],
      tab3BusRisk: "",
      tab3BusRegion: "",

      isBusNumber: false,
      busNumberType: [
        { name: "10人及以上" },
        { name: "6-9人" },
        { name: "3-5人" },
        { name: "1-2人" },
        { name: "兼职" }
      ],
      tab3BusNumber: "",

      userName: "",
      currentDateNow: "",

      phones: "",
      isPhone: false,
      isRound: false,
            filesObj: {
        name: "",
        type: "",
        index: ''
      },
      headerImage: "",
      picValue: "",
      upImgUrl: "",
      scrollTop1: 0,
      scrollTop2: 0,
      scrollTop3: 0,
      scrollTop4: 0,
      curScrollTop: 0,
      isErr: false
    };
  },
  mounted() {
    window.leftBack = this.leftBack; // Android原生返回按钮执行leftBack()方法
    document.documentElement.scrollTop = 0;

    var customer_id = this.$route.query.id;
    var site_id = this.$route.query.site_id;
    this.customer_id = customer_id;
    this.site_id = site_id;
    this.userName = localStorage.getItem("userName");

    let toCustomDetail = localStorage.getItem("toCustomDetail");
    if (toCustomDetail) {
      this.stationActive = "业绩及跟进";
    } else {
      this.stationActive = "站点基本情况";
    }

    document.documentElement.scrollTop = 0;
    window.addEventListener("scroll", this.scrollBottomGenjin);
    this.scrollTop1 = 0
    this.scrollTop2 = 0
    this.scrollTop3 = 0
    this.scrollTop4 = 0
    this.curScrollTop = 0
    this.detail();
    this.genUserList()
    this.genjinDetal();
  },
  methods: {
    changeScroll(type) {
      if(type == 1) {
        document.querySelector('#zhanzhang').scrollIntoView()
      } else if(type == 2) {
        document.querySelector('#zhandian').scrollIntoView()
      } else if(type == 3) {
        document.querySelector('#kehu').scrollIntoView()
      } else if(type == 4) {
        document.querySelector('#jiaoyi').scrollIntoView()
      } 
    },
    // 客户详情
    detail(isFirstSave) {
      let that = this
      this.isErr = false
      this.$api.stationDetail({ customer_id: this.customer_id, type: 2 }).then((res) => {
          // console.log(res)
          if (res.errno === 0) {
            if (res.data) {
              this.stationDetail = res.data;
              this.site_id = res.data.site_id;
              if (res.data.activeDate) {
                let activeDateArray = res.data.activeDate.split("/");
                this.activeDate =
                  activeDateArray[2] +
                  "-" +
                  activeDateArray[0] +
                  "-" +
                  activeDateArray[1];
              }

              if (res.data.label) {
                let label = res.data.label;
                this.labelArray = label.substr(0, label.length).split("#");
              } else {
                this.labelArray = [];
              }
              this.tab1Name = res.data.customerName;
              this.tab1Mobile = res.data.phones;
              // this.getDetail();
              if (res.site_data) {
                this.siteDetail = res.site_data;
                this.tab1Name = this.siteDetail.site_name ? this.siteDetail.site_name : res.data.customerName;
                this.tab1Mobile = this.siteDetail.sign_phone ? this.siteDetail.sign_phone : res.data.phones;
                this.dateBirth = this.siteDetail.date_of_birth ? this.siteDetail.date_of_birth : ''
                this.tab1Educatione = this.siteDetail.edu ? this.siteDetail.edu : ''
                this.bankWork = this.siteDetail.work ? this.siteDetail.work : ''
                this.tab3BusNumber = this.siteDetail.the_num ? this.siteDetail.the_num : ''
                this.tab1Sex = this.siteDetail.sex;
                let you_address = this.siteDetail.you_address;
                if (you_address) {
                  if (you_address.indexOf("/") == -1) {
                    // 不包含/
                    this.tab1Addtail = you_address;
                  } else {
                    let addArr = you_address
                      .substr(0, you_address.length)
                      .split("/");
                    addArr.forEach((ele) => {
                      this.tab1Region += ele;
                    });
                  }
                } else {
                  this.tab1Region = "";
                }

                // 营业执照
                this.tab2BusPics = this.siteDetail.business_pic;
                if (this.tab2BusPics) {
                  var pics = this.tab2BusPics;
                  pics = pics.split("#");
                  var r = pics.filter(function(s) {
                    return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
                  });
                  this.tab2BusPicsArray = r;
                  r = r.map(item => ({ url: item }));
                  this.tab2BusPicList = JSON.parse(JSON.stringify(r));
                } else {
                  this.tab2BusPics = "";
                  this.tab2BusPicsArray = [];
                  this.tab2BusPicList = [];
                }

                // 门头
                this.tab2BusDoorPics = this.siteDetail.door_pic;
                if (this.tab2BusDoorPics) {
                  var pics = this.tab2BusDoorPics;
                  pics = pics.split("#");
                  var r = pics.filter(function(s) {
                    return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
                  });
                  this.tab2BusDoorPicsArray = r;
                  r = r.map(item => ({ url: item }));
                  this.tab2BusDoorPicList = JSON.parse(JSON.stringify(r));
                } else {
                  this.tab2BusDoorPics = "";
                  this.tab2BusDoorPicsArray = [];
                  this.tab2BusDoorPicList = [];
                }

                // 店内环境
                this.tab2BusInPics = this.siteDetail.store_pic;
                if (this.tab2BusInPics) {
                  var pics = this.tab2BusInPics;
                  pics = pics.split("#");
                  var r = pics.filter(function(s) {
                    return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
                  });
                  this.tab2BusInPicsArray = r;
                  r = r.map(item => ({ url: item }));
                  this.tab2BusInPicList = JSON.parse(JSON.stringify(r));
                } else {
                  this.tab2BusInPics = "";
                  this.tab2BusInPicsArray = [];
                  this.tab2BusInPicList = [];
                }

                this.tab3BusType = this.siteDetail.business_type;
                this.tab3BusEquipment = this.siteDetail.device;
                this.tab3BusCardNum = this.siteDetail.card_num ? this.siteDetail.card_num : '';
                this.tab3BusCcbRadio = String(this.siteDetail.credit_card)

                // 建行收款码
                this.tab3BusCcbPics = this.siteDetail.collection_pic;
                if (this.tab3BusCcbPics) {
                  var pics = this.tab3BusCcbPics;
                  pics = pics.split("#");
                  var r = pics.filter(function(s) {
                    return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
                  });
                  this.tab3BusCcbPicsArray = r;
                  r = r.map(item => ({ url: item }));
                  this.tab3BusCcbPicList = JSON.parse(JSON.stringify(r));
                } else {
                  this.tab3BusCcbPics = "";
                  this.tab3BusCcbPicsArray = [];
                  this.tab3BusCcbPicList = [];
                }

                this.tab3BusVIRadio = this.siteDetail.site_VI;
                this.tab3BusRisk = this.siteDetail.risk;

                let business_address = this.siteDetail.business_address;
                if (business_address) {
                  if (business_address.indexOf("/") == -1) {
                    // 不包含/
                    this.tab3BusRegion = business_address;
                  } else {
                    let addArr = business_address
                      .substr(0, business_address.length)
                      .split("/");
                    addArr.forEach((ele) => {
                      this.tab3BusRegion += ele;
                    });
                  }
                } else {
                  this.tab3BusRegion = "";
                }
                this.currentDateNow = this.siteDetail.add_time.substr(0, 10);
              }
            }
            if (document.querySelector('.base-right-con')) {
              this.scrollTop1 = document.querySelector('#zhanzhang').offsetTop-8
              this.scrollTop2 = document.querySelector('#zhandian').offsetTop-8
              this.scrollTop3 = document.querySelector('#kehu').offsetTop-8
              this.scrollTop4 = document.querySelector('.base-right-con').scrollHeight - document.querySelector('.base-right-con').offsetHeight
              this.curScrollTop =  document.querySelector('#zhanzhang').offsetTop-8
              if (!isFirstSave) {
                document.querySelector('.base-right-con').scrollTop = 0
                document.querySelector('.base-right-con').onscroll  = () => {
                  that.curScrollTop = document.querySelector('.base-right-con').scrollTop
                }
              }
            }
          } else {
            this.$toast(res.errmsg);
            this.isErr = true
            if (document.querySelector('.base-right-con')) {
              this.scrollTop1 = document.querySelector('#zhanzhang').offsetTop-8
              this.scrollTop2 = document.querySelector('#zhandian').offsetTop-8
              this.scrollTop3 = document.querySelector('#kehu').offsetTop-8
              this.scrollTop4 = document.querySelector('.base-right-con').scrollHeight - document.querySelector('.base-right-con').offsetHeight
              this.curScrollTop =  document.querySelector('#zhanzhang').offsetTop-8
              if (!isFirstSave) {
                document.querySelector('.base-right-con').scrollTop = 0
                document.querySelector('.base-right-con').onscroll  = () => {
                  that.curScrollTop = document.querySelector('.base-right-con').scrollTop
                }
              }
            }
          }
        }).catch(err =>{
          this.isErr = true
        });
    },
    scrollBottomGenjin(e) {
      let that = this;
      var scrollTop =
        e.target.documentElement.scrollTop || e.target.body.scrollTop;

      let clientHeight = document.documentElement.clientHeight; /*当前可视高度*/
      let scrollHeight = Math.max(
        document.body.scrollHeight,
        document.documentElement.scrollHeight
      ); /*文档完整的高度*/
      if (
        scrollHeight - clientHeight - scrollTop <= 0 &&
        that.page < that.totalPage
      ) {
        that.page += 1;
        that.loading = 1;
        that.genjinDetal();
      }
    },
    genjinDetal(){
      let that = this;
      let data = {}
        data.page = that.page
        data.size = that.pageSize
        data.customer_id = this.customer_id
        data.user_id = this.selectId
        data.cls = 2

      this.$api.stationGenjin(data).then((res) => {
        that.totalPage = res.data.total;
          if (res.errno === 0) {
            if (that.page == 1) {
              that.loading = 0;
              that.genjin = res.data.data;
            } else if (res.data.data.length > 0) {
              that.genjin.push(...res.data.data);
              if (res.data.data.length < that.pageSize ||(res.data.data.length == that.pageSize && that.page == that.totalPage)) {
                that.loading = 0;
              }
            } else if (that.page == that.totalPage) {
              that.loading = 0;
            }

          } else {
            that.loading = 0;
            that.genjin = []
            this.$toast(res.errmsg);
          }
      });
    },
    getDetail(isFirstSave) {
      // 站点统计详情
      let that = this
      this.$api.siteStatiseDetail({ site_id: this.site_id }).then((res) => {
        if (res.errno === 0) {
          if (res.data) {
            this.siteDetail = res.data;
            this.tab1Name = res.data.site_name;
            this.tab1Mobile = res.data.sign_phone;
            this.tab1Sex = res.data.sex;
            let you_address = res.data.you_address;
            if (you_address) {
              if (you_address.indexOf("/") == -1) {
                // 不包含/
                this.tab1Addtail = you_address;
              } else {
                let addArr = you_address
                  .substr(0, you_address.length)
                  .split("/");
                addArr.forEach((ele) => {
                  this.tab1Region += ele;
                });
              }
            } else {
              this.tab1Region = "";
            }
            // 营业执照
            this.tab2BusPics = res.data.business_pic;
            if (this.tab2BusPics) {
              var pics = this.tab2BusPics;
              pics = pics.split("#");
              var r = pics.filter(function(s) {
                return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
              });
              this.tab2BusPicsArray = r;
              r = r.map(item => ({ url: item }));
              this.tab2BusPicList = JSON.parse(JSON.stringify(r));
            } else {
              this.tab2BusPics = "";
              this.tab2BusPicsArray = [];
              this.tab2BusPicList = [];
            }
            // 门头
            this.tab2BusDoorPics = res.data.door_pic;
            if (this.tab2BusDoorPics) {
              var pics = this.tab2BusDoorPics;
              pics = pics.split("#");
              var r = pics.filter(function(s) {
                return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
              });
              this.tab2BusDoorPicsArray = r;
              r = r.map(item => ({ url: item }));
              this.tab2BusDoorPicList = JSON.parse(JSON.stringify(r));
            } else {
              this.tab2BusDoorPics = "";
              this.tab2BusDoorPicsArray = [];
              this.tab2BusDoorPicList = [];
            }
            // 店内环境
            this.tab2BusInPics = res.data.store_pic;
            if (this.tab2BusInPics) {
              var pics = this.tab2BusInPics;
              pics = pics.split("#");
              var r = pics.filter(function(s) {
                return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
              });
              this.tab2BusInPicsArray = r;
              r = r.map(item => ({ url: item }));
              this.tab2BusInPicList = JSON.parse(JSON.stringify(r));
            } else {
              this.tab2BusInPics = "";
              this.tab2BusInPicsArray = [];
              this.tab2BusInPicList = [];
            }

            this.tab3BusType = res.data.business_type;
            this.tab3BusEquipment = res.data.device;
            this.tab3BusCardNum = res.data.card_num ? res.data.card_num : '';
            this.tab3BusCcbRadio = String(res.data.credit_card)

            // 建行收款码
            this.tab3BusCcbPics = res.data.collection_pic;
            if (this.tab3BusCcbPics) {
              var pics = this.tab3BusCcbPics;
              pics = pics.split("#");
              var r = pics.filter(function(s) {
                return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
              });
              this.tab3BusCcbPicsArray = r;
              r = r.map(item => ({ url: item }));
              this.tab3BusCcbPicList = JSON.parse(JSON.stringify(r));
            } else {
              this.tab3BusCcbPics = "";
              this.tab3BusCcbPicsArray = [];
              this.tab3BusCcbPicList = [];
            }

            this.tab3BusVIRadio = res.data.site_VI;
            this.tab3BusRisk = res.data.risk;

            let business_address = res.data.business_address;
            if (business_address) {
              if (business_address.indexOf("/") == -1) {
                // 不包含/
                this.tab3BusRegion = business_address;
              } else {
                let addArr = business_address
                  .substr(0, business_address.length)
                  .split("/");
                addArr.forEach((ele) => {
                  this.tab3BusRegion += ele;
                });
              }
            } else {
              this.tab3BusRegion = "";
            }
            this.currentDateNow = res.data.add_time.substr(0, 10);
          }
          if (document.querySelector('.base-right-con')) {
            this.scrollTop1 = document.querySelector('#zhanzhang').offsetTop-8
            this.scrollTop2 = document.querySelector('#zhandian').offsetTop-8
            this.scrollTop3 = document.querySelector('#kehu').offsetTop-8
            this.scrollTop4 = document.querySelector('.base-right-con').scrollHeight - document.querySelector('.base-right-con').offsetHeight
            this.curScrollTop =  document.querySelector('#zhanzhang').offsetTop-8
            if (!isFirstSave) {
              document.querySelector('.base-right-con').scrollTop = 0
              document.querySelector('.base-right-con').onscroll  = () => {
                that.curScrollTop = document.querySelector('.base-right-con').scrollTop
              }
            }
          }
        } else {
          this.currentDateNow = "暂未填写";
          if (document.querySelector('.base-right-con')) {
            this.scrollTop1 = document.querySelector('#zhanzhang').offsetTop-8
            this.scrollTop2 = document.querySelector('#zhandian').offsetTop-8
            this.scrollTop3 = document.querySelector('#kehu').offsetTop-8
            this.scrollTop4 = document.querySelector('.base-right-con').scrollHeight - document.querySelector('.base-right-con').offsetHeight
            this.curScrollTop =  document.querySelector('#zhanzhang').offsetTop-8
            document.querySelector('.base-right-con').scrollTop = 0
            document.querySelector('.base-right-con').onscroll  = () => {
              that.curScrollTop = document.querySelector('.base-right-con').scrollTop
            }
          }
        }
      });
    },
    genUserList(){
      this.$api.followUserLists({
          customer_id: this.customer_id,
          cls: 2
        }).then(res => {
          if (res.errno === 0) {
            this.tipList = res.data;
          }
        });
    },
    selTip(id){
      this.selectId = id
      this.page = 1;
      this.genjin = []
      this.genjinDetal()
    },
    // 若无联系方式可修改联系方式
    editPhones() {
      let that = this;
      let telreg = /^1[3456789]\d{9}$/;
      if (!telreg.test(that.phones)) {
        that.$toast("请输入正确的手机号!");
        return;
      }
      if (that.stationDetail.customer_id) {
        this.$api
          .phoneMod({
            customer_id: that.stationDetail.customer_id,
            phone: that.phones,
          })
          .then((res) => {
            if (res.errno === 0) {
              that.stationDetail.phones = that.phones;
            } else {
              this.$toast(res.errmsg);
            }
          });
      }
    },
    dialNum() {
      // 统计打电话次数
      this.$api.dialNum().then((res) => {});
    },
    siteStatiseAdd(id, site_id) {
      this.$router.push({
        path: "/siteAdd",
        query: {
          id: id,
          site_id: site_id,
          cls: 2,
        },
      });
    },
    leftBack() {
      this.$router.go(-1);
    },
    onClick(tab) {
      if (tab == '站点基本情况') {
        let toCustomDetail = localStorage.getItem("toCustomDetail");
       if (toCustomDetail) {
         let that = this
         setTimeout(() =>{
            this.scrollTop1 = document.querySelector('#zhanzhang').offsetTop-8
            this.scrollTop2 = document.querySelector('#zhandian').offsetTop-8
            this.scrollTop3 = document.querySelector('#kehu').offsetTop-8
            this.scrollTop4 = document.querySelector('.base-right-con').scrollHeight - document.querySelector('.base-right-con').offsetHeight
            this.curScrollTop =  document.querySelector('#zhanzhang').offsetTop-8
            document.querySelector('.base-right-con').scrollTop = 0
            document.querySelector('.base-right-con').onscroll  = () => {
              that.curScrollTop = document.querySelector('.base-right-con').scrollTop
            }
            localStorage.removeItem('toCustomDetail')
         }, 200)
       }
      }
      document.documentElement.scrollTop = 0;
    },
    closeType() {
      var type = this.type;
      var arr = type.filter((ele) => {
        return ele.ischecked;
      });
      arr = JSON.parse(JSON.stringify(arr));
      var labelArray = [];
      var customer_tag_id = "";
      arr.forEach((ele) => {
        labelArray.push(ele.tag_name);
        customer_tag_id += ele.customer_tag_id + ",";
      });
      this.isType = false;

      var data = {};
      data.type = 2; // 建行客户
      data.user_id = this.customer_id;
      data.customer_tag_id = customer_tag_id;
      this.$api.tagUserUpdate(data).then((res) => {
        localStorage.setItem("tagupdate", "1"); // 判断是否更新标签操作，到列表页面是否需要刷新
        if (res.errno === 0) {
          this.labelArray = labelArray;
        } else {
          this.$toast(res.errmsg);
        }
      });
    },
    closePopup() {
      localStorage.removeItem("tagupdate");
    },
    toGenjin(id, name, site_id) {
      this.$router.push({
        path: "/customerGenjin",
        query: {
          customer_id: id,
          station_id: 0,
          customerName: name,
          cls: 2,
          site_id: site_id,
        },
      });
    },
    tagList() {
      // 获取标签列表
      let that = this;
      that.isType = true;
      this.$api.tagList({ type: 2 }).then((res) => {
        if (res.errno === 0) {
          if (res.data) {
            that.type = [];
            res.data.forEach((ele) => {
              let tag_name = ele.tag_name;
              if (that.labelArray.indexOf(tag_name) > -1) {
                ele.ischecked = true;
              } else {
                ele.ischecked = false;
              }
              that.type.push(ele);
            });
          }
        } else {
          this.$toast(res.errmsg);
        }
      });
    },
    genjinDetail(follow_id) {
      this.$router.push({
        path: "/genjinDetail",
        query: {
          follow_id: follow_id,
        },
      });
    },
           // 上传营业执照
    afterRead1(file, detail) {
      let that = this;
      that.filesObj.name = file.file.name; // 获取文件名
      that.filesObj.type = file.file.type; // 获取类型
      that.filesObj.index = detail.index
      that.tab2BusPicList[that.filesObj.index].content = ''
      that.tab2BusPicList[that.filesObj.index].status = 'uploading'
      that.tab2BusPicList[that.filesObj.index].message = '上传中...'
      that.picValue = file.file; // 文件流
      that.imgPreview(this.picValue, 1);
    },
    // 上传门头
    afterRead2(file, detail) {
      let that = this;
      that.filesObj.name = file.file.name; // 获取文件名
      that.filesObj.type = file.file.type; // 获取类型
      that.filesObj.index = detail.index
      that.tab2BusDoorPicList[that.filesObj.index].content = ''
      that.tab2BusDoorPicList[that.filesObj.index].status = 'uploading'
      that.tab2BusDoorPicList[that.filesObj.index].message = '上传中...'
      that.picValue = file.file; // 文件流
      that.imgPreview(this.picValue, 2);
    },
    // 上传店内环境
    afterRead3(file, detail) {
      let that = this;
      that.filesObj.name = file.file.name; // 获取文件名
      that.filesObj.type = file.file.type; // 获取类型
      that.filesObj.index = detail.index
      that.tab2BusInPicList[that.filesObj.index].content = ''
      that.tab2BusInPicList[that.filesObj.index].status = 'uploading'
      that.tab2BusInPicList[that.filesObj.index].message = '上传中...'
      that.picValue = file.file; // 文件流
      that.imgPreview(this.picValue, 3);
    },
    // 上传建行收款码
    afterRead4(file, detail) {
      let that = this;
      that.filesObj.name = file.file.name; // 获取文件名
      that.filesObj.type = file.file.type; // 获取类型
      that.filesObj.index = detail.index
      that.tab3BusCcbPicList[that.filesObj.index].content = ''
      that.tab3BusCcbPicList[that.filesObj.index].status = 'uploading'
      that.tab3BusCcbPicList[that.filesObj.index].message = '上传中...'
      that.picValue = file.file; // 文件流
      that.imgPreview(this.picValue, 4);
    },
    // 处理图片
    imgPreview(file, num) {
      let that = this;
      let Orientation;
      //去获取拍照时的信息，解决拍出来的照片旋转问题
      Exif.getData(file, function() {
        Orientation = Exif.getTag(this, "Orientation");
      });
      // 看支持不支持FileReader
      if (!file || !window.FileReader) return;
      if (/^image/.test(file.type)) {
        let reader = new FileReader(); // 创建一个reader
        reader.readAsDataURL(file); // 将图片2将转成 base64 格式
        reader.onloadend = function() {
          // 读取成功后的回调
          // console.log(this.result)
          let result = this.result;
          let img = new Image();
          img.src = result;
          //判断图片是否大于500K,是就直接上传，反之压缩图片
          if (this.result.length <= 500 * 1024) {
            that.headerImage = this.result;
            that.postImg(num);
          } else {
            img.onload = function() {
              let data = that.compress(img, Orientation);
              that.headerImage = data;
              that.postImg(num);
            };
          }
        };
      }
    },
    // 压缩图片
    compress(img, Orientation) {
      let canvas = document.createElement("canvas");
      let ctx = canvas.getContext("2d");

      let tCanvas = document.createElement("canvas");
      let tctx = tCanvas.getContext("2d");

      let width = img.width;
      let height = img.height;
      //如果图片大于四百万像素，计算压缩比并将大小压至400万以下
      let ratio;
      if ((ratio = (width * height) / 4000000) > 1) {
        // console.log("大于400万像素");
        ratio = Math.sqrt(ratio);
        width /= ratio;
        height /= ratio;
      } else {
        ratio = 1;
      }
      canvas.width = width;
      canvas.height = height; //        铺底色
      ctx.fillStyle = "#fff";
      ctx.fillRect(0, 0, canvas.width, canvas.height); //如果图片像素大于100万则使用瓦片绘制
      let count;
      if ((count = (width * height) / 1000000) > 1) {
        // console.log("超过100W像素");
        count = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片 //            计算每块瓦片的宽和高
        let nw = ~~(width / count);
        let nh = ~~(height / count);
        tCanvas.width = nw;
        tCanvas.height = nh;
        for (let i = 0; i < count; i++) {
          for (let j = 0; j < count; j++) {
            tctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);
            ctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);
          }
        }
      } else {
        ctx.drawImage(img, 0, 0, width, height);
      }
      //修复ios上传图片的时候 被旋转的问题
       if (Orientation != "" && Orientation != 1) {
          switch (Orientation) {
              case 6: //需要顺时针（向左）90度旋转
                  this.rotateImg(img, "left", canvas);
                  break;
               case 8: //需要逆时针（向右）90度旋转
                   this.rotateImg(img, "right", canvas);
                   break;
               case 3: //需要180度旋转
                   this.rotateImg(img, "right", canvas); //转两次
                   this.rotateImg(img, "right", canvas);
                   break;
           }
        }
            //进行最小压缩
            let ndata = canvas.toDataURL("image/jpeg", 0.1);
            tCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;
            return ndata;
    },
    // 旋转图片
        rotateImg(img, direction, canvas) {
            //最小与最大旋转方向，图片旋转4次后回到原方向
            const min_step = 0;
            const max_step = 3;
            if (img == null) return;
            //img的高度和宽度不能在img元素隐藏后获取，否则会出错
            let height = img.height;
            let width = img.width;
            let step = 2;
            if (step == null) {
                step = min_step;
            }
            if (direction == "right") {
                step++;
                //旋转到原位置，即超过最大值
                step > max_step && (step = min_step);
            } else {
                step--;
                step < min_step && (step = max_step);
            }
            //旋转角度以弧度值为参数
            let degree = (step * 90 * Math.PI) / 180;
            let ctx = canvas.getContext("2d");
            switch (step) {
                case 0:
                    canvas.width = width;
                    canvas.height = height;
                    ctx.drawImage(img, 0, 0);
                    break;
                case 1:
                    canvas.width = height;
                    canvas.height = width;
                    ctx.rotate(degree);
                    ctx.drawImage(img, 0, -height);
                    break;
                case 2:
                    canvas.width = width;
                    canvas.height = height;
                    ctx.rotate(degree);
                    ctx.drawImage(img, -width, -height);
                    break;
                case 3:
                    canvas.width = height;
                    canvas.height = width;
                    ctx.rotate(degree);
                    ctx.drawImage(img, -width, 0);
                    break;
            }
        },
        //将base64转换为文件
        dataURLtoFile(dataurl) {
            var arr = dataurl.split(","),
                bstr = atob(arr[1]),
                n = bstr.length,
                u8arr = new Uint8Array(n);
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new File([u8arr], this.filesObj.name, {
                type: this.filesObj.type
            });
        },
         //接口上传图片
        postImg(num){
          let file = this.dataURLtoFile(this.headerImage);
          let token = localStorage.getItem("token");
          var formdata = new FormData();
          formdata.append("token", token);
          formdata.append("file", file)
          const instance = this.$axios.create({
            //withCredentials:true
          });
          instance.post("http://crm.xfd365.com/user/base/uploadImg", formdata).then(res => {
            if (res.data.errno === 0) {
              this.$toast("上传成功");
              if(num == 1){
                this.tab2BusPicList[this.filesObj.index].content = res.data.data.url
                this.tab2BusPicList[this.filesObj.index].status = 'done'
                this.tab2BusPicList[this.filesObj.index].message = ''
                this.tab2BusPicsArray.push(res.data.data.url);
              }else if(num == 2){
                this.tab2BusDoorPicList[this.filesObj.index].content = res.data.data.url
                this.tab2BusDoorPicList[this.filesObj.index].status = 'done'
                this.tab2BusDoorPicList[this.filesObj.index].message = ''
                this.tab2BusDoorPicsArray.push(res.data.data.url);
              }else if(num == 3){
                this.tab2BusInPicList[this.filesObj.index].content = res.data.data.url
                this.tab2BusInPicList[this.filesObj.index].status = 'done'
                this.tab2BusInPicList[this.filesObj.index].message = ''
                this.tab2BusInPicsArray.push(res.data.data.url);
              }else if(num == 4){
                this.tab3BusCcbPicList[this.filesObj.index].content = res.data.data.url
                this.tab3BusCcbPicList[this.filesObj.index].status = 'done'
                this.tab3BusCcbPicList[this.filesObj.index].message = ''
                this.tab3BusCcbPicsArray.push(res.data.data.url);
              }
              this.saveTab();
            } else {
              this.$toast(res.errmsg);
              if(num == 1){
                this.tab2BusPicList[this.filesObj.index].status = 'failed'
                this.tab2BusPicList[this.filesObj.index].message = '上传失败'
              }else if(num == 2){
                this.tab2BusDoorPicList[this.filesObj.index].status = 'failed'
                this.tab2BusDoorPicList[this.filesObj.index].message = '上传失败'
              }else if(num == 3){
                this.tab2BusInPicList[this.filesObj.index].status = 'failed'
                this.tab2BusInPicList[this.filesObj.index].message = '上传失败'
              }else if(num == 4){
                this.tab3BusCcbPicList[this.filesObj.index].status = 'failed'
                this.tab3BusCcbPicList[this.filesObj.index].message = '上传失败'
              }

            }
          }, err=>{
            // console.log(err)
            if(num == 1){
              this.tab2BusPicList[this.filesObj.index].status = 'failed'
              this.tab2BusPicList[this.filesObj.index].message = '上传失败'
            }else if(num == 2){
              this.tab2BusDoorPicList[this.filesObj.index].status = 'failed'
              this.tab2BusDoorPicList[this.filesObj.index].message = '上传失败'
            }else if(num == 3){
              this.tab2BusInPicList[this.filesObj.index].status = 'failed'
              this.tab2BusInPicList[this.filesObj.index].message = '上传失败'
            }else if(num == 4){
              this.tab3BusCcbPicList[this.filesObj.index].status = 'failed'
              this.tab3BusCcbPicList[this.filesObj.index].message = '上传失败'
            }

          });

        },
    handleTime(value) {
      var d = new Date(value);
      var datetime =
        d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
      this.dateBirth = datetime;
      this.isBirth = false;
      this.saveTab();
    },
    onSelectEducate(item) {
      // 教育程度
      this.tab1Educatione = item.name;
      this.isEducate = false;
      this.saveTab();
    },
    onSelectBankType(item) {
      // 银行业务熟悉情况
      this.bankWork = item.name;
      this.isBankType = false;
      this.saveTab();
    },
    onSelectBusNumber(item) {
      // 经营规模
      this.tab3BusNumber = item.name;
      this.isBusNumber = false;
      this.saveTab();
    },
        // 删除营业执照
    beforeDelete1(file ,detail){
      let index = detail.index
      this.tab2BusPicsArray.splice(index, 1);
      this.tab2BusPicList.splice(index, 1);
      this.saveTab();
    },
    // 删除门头
    beforeDelete2(file ,detail){
      let index = detail.index
      this.tab2BusDoorPicsArray.splice(index, 1);
      this.tab2BusDoorPicList.splice(index, 1);
      this.saveTab();
    },
    // 删除店内环境
    beforeDelete3(file ,detail){
      let index = detail.index
      this.tab2BusInPicsArray.splice(index, 1);
      this.tab2BusInPicList.splice(index, 1);
      this.saveTab();
    },
    // 删除建行收款码
    beforeDelete4(file ,detail){
      let index = detail.index
      this.tab3BusCcbPicsArray.splice(index, 1);
      this.tab3BusCcbPicList.splice(index, 1);
      this.saveTab();
    },
    // 修改为实时保存
    changeInput() {
      this.saveTab();
    },
    blurInput(){
      this.saveTab();
    },
    // 保存站点信息
    saveTab(){
      // 签约手机号
      let reg = /^1[0-9]{10}$/;
      if (!reg.test(this.tab1Mobile) && this.tab1Mobile.trim().length > 0) {
        this.$toast("请输入正确手机号！");
        return;
      }

      // 营业执照
      this.tab2BusPics = "";
      if (this.tab2BusPicsArray != "") {
        this.tab2BusPicsArray.forEach(ele => {
          this.tab2BusPics += ele + "#";
        });
      }
      // 门头
      this.tab2BusDoorPics = "";
      if (this.tab2BusDoorPicsArray != "") {
        this.tab2BusDoorPicsArray.forEach(ele => {
          this.tab2BusDoorPics += ele + "#";
        });
      }
      // 店内环境
      this.tab2BusInPics = "";
      if (this.tab2BusInPicsArray != "") {
        this.tab2BusInPicsArray.forEach(ele => {
          this.tab2BusInPics += ele + "#";
        });
      }
      // 建行收款码
      this.tab3BusCcbPics = "";
      if (this.tab3BusCcbPicsArray != "") {
        this.tab3BusCcbPicsArray.forEach(ele => {
          this.tab3BusCcbPics += ele + "#";
        });
      }
      var data = {};
      data.site_name = this.tab1Name;
      data.sign_phone = this.tab1Mobile;
      data.date_of_birth = this.dateBirth;

      data.idcard = this.siteDetail.idcard;
      data.nation = this.siteDetail.nation;

      data.sex = this.tab1Sex;

      data.edu = this.tab1Educatione;
      data.work = this.bankWork;
      data.wx_mobile = this.siteDetail.wx_mobile;
      data.address_phone = this.siteDetail.address_phone;
      data.postal_code = this.siteDetail.postal_code;
      data.you_address = this.siteDetail.you_address;
      data.marital = this.siteDetail.marital;
      data.spouse_name = this.siteDetail.spouse_name;
      data.spouse_phone = this.siteDetail.spouse_phone;
      data.spouse_idcard = this.siteDetail.spouse_idcard;
      data.business_name = this.siteDetail.business_name;

      data.business_pic = this.tab2BusPics;
      data.door_pic = this.tab2BusDoorPics;
      data.store_pic = this.tab2BusInPics;

      data.business = this.siteDetail.business;
      data.business_site_name = this.siteDetail.business_site_name;

      data.business_type = this.tab3BusType;
      data.device = this.tab3BusEquipment;
      data.card_num = this.tab3BusCardNum;
      data.credit_card = this.tab3BusCcbRadio;
      data.collection_pic = this.tab3BusCcbPics;
      data.site_VI = this.tab3BusVIRadio;
      data.risk = this.tab3BusRisk;


      data.business_size = this.siteDetail.business_size;
      data.year_amount = this.siteDetail.year_amount;
      data.the_num = this.tab3BusNumber;
      data.business_address = this.siteDetail.business_address;
      data.hold_card = this.siteDetail.hold_card;
      data.loans = this.siteDetail.loans;
      data.payment_term = this.siteDetail.payment_term;
      data.site_he_bank = this.siteDetail.site_he_bank;
      data.site_he_bankname = this.siteDetail.site_he_bankname;
      data.one_bane = this.siteDetail.one_bane;

      data.site_id = this.site_id;
      data.user_id = localStorage.getItem("userId");

      data.user_type = 2;  //1新增，2建行
      data.customer_id = this.customer_id;
      // console.log(data)
      // return
      this.$api.siteStatiseAdd(data).then(res => {
        if (res.errno === 0) {
          // this.$toast("添加成功");
          // 更新siteId
          let ifFirstAdd = false
          if(this.site_id.length == 0){
            ifFirstAdd = true
          }
          this.site_id = res.data.site_id
          if(ifFirstAdd){
            this.detail(true)
          }

        } else {
          this.$toast(res.errmsg);
        }
      });
    },
    // 选择性别
    selectSex(index) {
      this.isSex = false;
      if (index == 0) {
        this.tab1Sex = "男";
      } else if (index == 1) {
        this.tab1Sex = "女";
      }
      this.saveTab();
    },
        onSelectBusEquipment(item) {
      // 裕农通设备
      this.tab3BusEquipment = item.name;
      this.isBusEquipment = false;
      this.saveTab();
    },
    tab3BusCcbRadioChange(){
      // 是否有建行信用卡
      this.saveTab();
    },
    tab3BusVIRadioChage(){
      // 站点VI标识
      this.saveTab()
    },
    onSelectBusRisk(item) {
      // 风险情况
      this.tab3BusRisk = item.name;
      this.isBusRisk = false;
      this.saveTab();
    },
  },
  destroyed: function () {
    // 离开页面时清空缓存状态
    localStorage.removeItem("toCustomDetail");
    window.removeEventListener('scroll', this.scrollBottomCcbIndex);//监听页面滚动事件
  },
};
</script>
<style lang="less">
.ccbCustomerDetail {
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  display: flex;
  align-items: center;
  flex-direction: column;
  background: #f5f5f5;
  .top {
    position: relative;
    top: 0;
    left: 0;
    z-index: 1;
    background: url(../../images/topBg.jpg) no-repeat;
    width: 100%;
    height: 130px;
    background-size: 100% 130px;
    > p {
      height: 50px;
      line-height: 50px;
      color: #fff;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding-left: 16px;
      img {
        width: 10px;
        height: 16px;
        margin-right: 10px;
      }
      span {
        line-height: 18px;
      }
    }
    > div {
      display: flex;
      justify-content: space-around;
      p {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-size: 14px;
        margin-top: 10px;
        img {
          width: 15px;
          height: 15px;
          margin-bottom: 10px;
        }
      }
      p:first-child {
        img {
          width: 13px;
          height: 13px;
        }
      }
    }
  }
  .base-other-box {
    position: relative;
    width: 100%;
    height: calc(100vh - 224px);
    overflow-y: auto;
    box-sizing: border-box;
    padding: 8px;
  }
  .base-box {
    position: relative;
    width: 100%;
    height: calc(100vh - 224px);
    overflow-y: auto;
    display: flex;
    align-items: center;
    padding: 8px;
    box-sizing: border-box;
    .base-left-con {
      .base-left-item {
        writing-mode:horizontal-tb;//默认：水平方向，从上到下 
        writing-mode:vertical-rl;  //垂直方向，从右向左
        writing-mode:vertical-lr;  //垂直方向，从左向右
        width: 22px;
        height: 70px;
        background: #1c5bd1;
        border-top-left-radius: 5px;
        border-bottom-left-radius: 5px;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 10px;
        opacity: 0.5;
      }
      .opacity {
        opacity: 1;
      }
    }
    .base-right-con {
      height: 100%;
      border-radius: 10px;
      overflow-y: auto;
    }
  }
  .err-con {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    .err-text {
      color: #666;
      font-size: 14px;
      margin-bottom: 15px;
    }
  }
  
  .tipList {
    padding: 10px 5px 5px 5px;
    .keyword {
      background: #ffffff;
      padding: 5px 15px;
      border-radius: 30px;
      margin: 5px;
      display: inline-flex;
      color: #333!important;
      &.active {
        background: #1989fa;
        color: #ffffff!important;
      }
    }
  }
  .listLi {
    font-size: 14px;
    display: flex;
    margin: 0 15px;
    padding: 10px 0;
    color: #444444;
    border-bottom: 1px solid #eeeeee;
    &.tagLi {
      padding-right: 14px;
      background: url(../../images/jiantou.png) no-repeat right;
      background-size: auto 16px;
    }
    .iconImg {
      width: 16px;
      text-align: center;
      flex: none;
      margin-right: 5px;
      img {
        max-width: 16px;
        max-height: 16px;
        margin-top: 2px;
      }
    }
    .title {
      flex: none;
      width: 90px;
      &.title7 {
        width: 110px;
      }
      &.title10 {
        width: 150px;
      }
    }
    .desc {
      width: 100%;
      text-align: right;
      .tips {
        color: #1c92ff;
        padding: 0 5px;
        display: inline-block;
        border-radius: 10px;
        margin: 2px;
        border: 1px solid #1c92ff;
      }
    }
  }
  .dataTitle {
    padding: 0 15px;
    font-size: 12px;
    line-height: 28px;
    font-weight: bold;
    color: #1c5bd1;
    opacity: 0.7;
  }
  .numDetail {
    background: #ffffff;
    .ulDiv {
      display: flex;
      justify-content: left;
      flex-wrap: wrap;
      div {
        width: 25%;
        text-align: center;
        padding: 10px 0;
        float: left;
        position: relative;
        &::after {
          position: absolute;
          content: " ";
          left: 0;
          right: 0;
          bottom: 0;
          height: 1px;
          background: #eeeeee;
        }
        &::before {
          position: absolute;
          content: " ";
          top: 0;
          right: 0;
          bottom: 0;
          width: 1px;
          background: #eeeeee;
        }
        span {
          display: block;
          line-height: 24px;
          &:first-child {
            color: #444444;
            font-size: 14px;
          }
        }
      }
    }
  }

  .van-tabs__wrap--scrollable .van-tab {
    flex-basis: 35% !important;
    padding: 0 3px;
  }
  .van-tabs {
    width: 100%;
    flex: 1;
    .van-tabs__wrap {
      // position: fixed;
      // left: 0;
      // right: 0;
      // z-index: 1;
      // box-shadow: 5px 5px 10px rgb(193 188 188);
    }
    // .van-tabs__content {
    //   padding-top: 48px;
    // }
    .genjinlCont {
      position: relative;
      &:last-child{
        margin-bottom: 10px;
      }
      .detailBtn {
        position: absolute;
        right: 15px;
        bottom: -10px;
        padding: 4px 20px;
        color: #ffffff;
        height: 18px;
        line-height: 18px;
        border-radius: 30px;
        background: linear-gradient(90deg, #0e6ef0 0%, #1c92ff 100%);
      }
    }
    .van-tab__pane {
      > div {
        p.fllow-title {
          font-size: 12px;
          padding-left: 20px;
          height: 24px;
          line-height: 24px;
          color: #aaa;
        }
        ul:first-of-type {
          padding: 10px;
          border-bottom: 1px solid #eeeeee;
          background: #fff;
          li {
            // height: 30px;
            line-height: 24px;
            color: #aaa;
            font-size: 14px;
            // display: flex;
            // align-items: center;
            position: relative;
            &:first-child {
              // line-height: 30px;
            }
            img {
              width: 15px;
              height: 15px;
              position: absolute;
              left: 0;
              top: 3px;
            }
            span {
              display: inline-block;
              line-height: 18px;
              padding-left: 25px;
            }
            &:nth-child(2) {
              span {
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
                width: calc(100% - 20px);
              }
            }
          }
          li:first-child {
            margin-bottom: 5px;
            img {
              width: 20px;
              height: 20px;
              position: absolute;
              left: 0;
              top: 3px;
            }
            span:first-of-type {
              color: #000;
            }
            span.tip {
              font-size: 12px;
              border: 1px solid #1c92ff;
              color: #1c92ff;
              height: 20px;
              line-height: 20px;
              padding-left: 3px;
              padding-right: 3px;
              border-radius: 20px;
              margin-left: 10px;
            }
            span.num{
              background: #1989fa;
              color: #fff;
              font-size: 12px;
              transform: scale(0.9);
              padding: 2px 5px;
              border-radius: 10px;
            }
          }
        }
      }
    }
  }
  .marBottom {
    margin-bottom: 10px;
    background: #fff;
  }
  .van-tabs__line {
    background-color: #1c92ff;
  }
      .van-cell{
      color: #646566;
    }
    .ifCcb{
      .van-cell__title{
        width: 72px;
      }
      .van-radio-group--horizontal{
        justify-content: flex-end;
        width: 100%;
      }
      .van-radio__icon .van-icon{
        font-size: 0.6em;
        margin-top: 2px;
      }
      .van-radio__label{
        margin-left: 5px;
      }
    }
  .van-image-preview__cover{
    width: 48px;
    height: 48px;
    text-align: center;
    line-height: 54px;
    bottom: 12% !important;
    left: calc(50% - 24px) !important;
    top: auto;
    font-size: 24px;
    color: #ffffff;
    border: 1px solid #ffffff;
    border-radius: 50%;
  }
  .van-uploader {
    background: #ffffff;
    padding: 10px 15px;
    width: calc(100% - 30px);
  }

  .van-loading {
    padding: 10px 0;
    text-align: center;
  }
  .bottomTip {
    display: flex;
    justify-content: space-between;
    padding: 0 15px;
    color: #aaaaaa;
    background: #f5f5f5;
    font-size: 14px;
    line-height: 32px;
  }
  .marBottom {
    margin-bottom: 10px;
    background: #ffffff;
  }
  .label4 .van-field__label {
    width: 60px;
  }
  .label7 .van-field__label {
    width: 100px;
  }
  .label8 .van-field__label {
    width: 116px;
  }
  .label9 .van-field__label {
    width: 136px;
  }
  .van-popup.tagPopup {
    width: 90%;
    border-radius: 10px;
    background: transparent;
    .content {
      position: relative;
      &::before{
        position: absolute;
        content: '';
        bottom: 0;
        height: calc(100% - 36px);
        width: 100%;
        background: #fff;
        z-index: -1;
      }
      .imgDiv{
        height: 36px;
        img{
          width: 70px;
          height: 70px;
        }
      }
      p {
        text-align: right;
        color: #aaaaaa;
        margin-top: 15px;
        margin-right: 15px;
      }
      ul {
        display: flex;
        justify-content: flex-start;
        flex-wrap: wrap;
        padding: 0 15px;
        li {
          height: 30px;
          padding: 0 10px;
          font-size: 16px;
          text-align: center;
          line-height: 30px;
          border-radius: 10px;
          margin-right: 10px;
          margin-top: 10px;
          border: 1px solid rgba(28, 146, 255, 1);
          background: rgba(28, 146, 255, 0.1);
          &.active {
            background: #1c92ff;
            border: 1px solid #1c92ff;
            color: #fff;
          }
        }
      }
      button {
        width: 100%;
        height: 49px;
        border: none;
        border-top: 1px solid #eeeeee;
        background: #fff;
        margin-top: 25px;
        color: #1c92ff;
        font-size: 16px;
      }
    }
  }
  .bottom {
    width: 100%;
    height: 50px;
    background: #fff;
    display: flex;
    justify-content: flex-start;
    > li {
      width: 33%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 14px;
      color: #bbb;
      img {
        width: 20px;
        height: 22px;
      }
    }
  }
  .van-popup.vanSheet {
    .van-action-sheet__header {
      text-align: left;
      padding-left: 20px;
    }
    ul {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      height: 84px;
      li {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin-left: 20px;
        img {
          width: 20px;
          height: 20px;
          margin-bottom: 5px;
        }
      }
    }

    p {
      border-bottom: 1px solid #eee;
      height: 50px;
      line-height: 50px;
      padding-left: 20px;
    }
  }
    .van-action-sheet.listSheet {
    .van-action-sheet__header,
    .van-action-sheet__item {
      padding: 0 20px;
    }
    .van-action-sheet__header {
      font-size: 15px;
      font-weight: bold;
    }
    .van-action-sheet__item {
      font-size: 14px;
      height: 42px;
      line-height: 42px;
      &:active {
        color: #1c92ff;
        background: rgba(28, 146, 255, 0.2);
      }
    }
  }
  .van-action-sheet.sexSheet {
    ul {
      display: flex;
      justify-content: space-around;
      padding: 20px 0;
      img {
        width: 28px;
        height: 30px;
      }
    }
  }
}
</style>
